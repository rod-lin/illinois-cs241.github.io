<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="apple-touch-icon" sizes="180x180" href="images/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="images/favicons/manifest.json">
  <link rel="mask-icon" href="images/favicons/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="theme-color" content="#ffffff">

  <title>Deadlocked Diners</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" crossorigin="anonymous">
  <link async rel="stylesheet" href="/css/code-style.css?v=2018-09-08 16:51:38 +0000">
  <link rel="stylesheet" href="/css/main.css?v=2018-09-08 16:51:38 +0000">

</head>

<body>
<!-- Always shows a header, even in smaller screens. -->
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">

            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>

            <a id="tuxlink"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAJCAMAAAA4jZ0cAAAAM1BMVEX///8CAgQMDAwsLCw0NDSjbQCkbQC+vbzOkwDU1NTlrADqvADxtgD0vQD12wD+/vz+//yBSdYEAAAAAXRSTlMAQObYZgAAADFJREFUCB0FwQkCQDAQBLCsq6g1/v9aCVQBthUwX8BIgStZCpUvKXSSLs6eyd0Pdg5+JwkBVyC74QYAAAAASUVORK5CYII=" title="Tux" alt="Tux" style="margin-left: 1em; width: 24px; filter: drop-shadow(1px 1px 0 white) drop-shadow(1px -1px 0 white) drop-shadow(-1px 1px 0 white) drop-shadow(-1px -1px 0 white); margin-top: 1em;"/></a>

            <a class="navbar-brand navbar-link normal" href="/">CS 241: System Programming</a>
            <a class="navbar-brand navbar-link small" href="/">CS 241</a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li>
            <a class="navbar-link" href="/mps.html">MPs</a>
            </li>
            <li>
            <a class="navbar-link" href="/labs.html">Labs</a>
            </li>
            <li>
            <a class="navbar-link" href="/help.html">Help!</a>
            </li>
            <li>
            <a class="navbar-link" href="/schedule.html">Schedule</a>
            </li>
            <li>
            <a class="navbar-link" href="/honors.html">Honors</a>
            </li>
            <li>
            <a class="navbar-link" href="/staff.html">The Crew</a>
            </li>
            <li>
            <a class="navbar-link" href="/search.html">Search</a>
            </li>
            <li>
            <a class="navbar-link" href="/wikibook/home.html">Wikibook</a>
            </li>
          </ul>
        </div>
        </div>
</nav>

<div class="container-fluid">
  <div class="row">
    <div class="col-md-2 col-sm-1 col-xs-0"></div>
    <div class="col-md-8 col-sm-10 col-xs-12">
      <div class="wrapper">
        <div class="pad"><div class="card">
          <div class="title">
            <div class="speaker-wrapper">
              <button onclick="speak()" class="speaker" alt="Read Page"></button>
            </div>
            <h1>
              Deadlocked Diners
              
                <a class="github-link hidden-xs" href="https://github.com/illinois-cs241/illinois-cs241.github.io/blob/develop/_docs/deadlocked_diners.md">Edit on Github</a>
              
            </h1>
          </div>
          <div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
            
              <div class="submission-wrapper">
                
                  <b>Entire Assignment</b> due <b>10/18 11:59pm</b><br/>
                  
                    <b>Graded files:</b>
                    <ul>
                      
                        <li>good_company.c</li>
                      
                    </ul>
                  
                
              </div>
            
          </div></div></div>
        </div></div>
      </div>
      <div class="toc-wrapper">
<h4>Content</h4>
<ul class="toc">
<li><a id="toc_backstory" href="#backstory" class="fancy-link">Backstory</a></li>
<li><a id="toc_your-job" href="#your-job" class="fancy-link">Your Job</a></li>
<li><a id="toc_testing" href="#testing" class="fancy-link">Testing</a></li>
<li><a id="toc_grading" href="#grading" class="fancy-link">Grading</a></li>
</ul>
</div>
      <div id="content">
        
        <div class="wrapper">
  <div class="pad"><div class="card">
<div class="title"><h2 id="learning-objectives" class="title-text">Learning Objectives<a class="anchor title-text" href="#learning-objectives">#</a>
</h2></div>
  
  


  <div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>
    The learning objectives for Deadlocked Diners are: <br>
    </p>
<ul class="mdl-list">
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Synchronization</span>
        </li>
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Deadlock / Livelock / Starvation</span>
        </li>
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Coffman Conditions</span>
        </li>
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Dining Philosophers</span>
        </li>
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Messing with Interns</span>
        </li>
      
    </ul>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="suggested-readings" class="title-text">Suggested Readings<a class="anchor title-text" href="#suggested-readings">#</a>
</h2></div>
  
  

<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>
    We suggest you read the following from the
    <a href="https://github.com/angrave/SystemProgramming/wiki" class="fancy-link wiki-link">wikibook</a>
    before starting Deadlocked Diners: <br>
    </p>
<ul>
      
        <li>
          <a href="/wikibook/deadlock-part-1-resource-allocation-graph.html#" target="_blank" class="fancy-link wiki-link">Deadlock, Part 1: Resource Allocation Graph
          </a>
        </li>
      
        <li>
          <a href="/wikibook/deadlock-part-2-deadlock-conditions.html#" target="_blank" class="fancy-link wiki-link">Deadlock, Part 2: Deadlock Conditions
          </a>
        </li>
      
        <li>
          <a href="/wikibook/deadlock-part-3-dining-philosophers.html#" target="_blank" class="fancy-link wiki-link">Deadlock, Part 3: Dining Philosophers
          </a>
        </li>
      
    </ul>
</div></div></div>
</div></div>
</div>
        <div class="wrapper">
<div class="pad"><div class="card">
<div class="title"><h2 id="backstory" class="title-text">Backstory<a class="anchor title-text" href="#backstory">#</a>
</h2></div>










<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>You are creating a start up that allows companies to rent <s>code monkeys</s> interns for a project.
They are billed by the number of days it takes to complete the project.
The reason why companies want to rent interns is because they realized they do not need dedicated interns,
since they do not always have projects at hand (sometimes they are contemplating about life).
Basically a company in 1 of 3 states: “trying to rent interns”, “working with interns” or “having a board meeting”.
They came to the conclusion that a possible way of handling this dilemma is to simply overwork the interns by having them work for 2 companies,
just not at the same time.</p>
<p>This is where you come along….</p>
<p>The scenario is as follows.
Each of the companies practices pair programming,
so you will need to find a way to schedule the interns so that we can continue to bill each company as often as possible.
This means that work on a project can only be completed when the company has <strong>TWO</strong> interns assigned to it.
There are <code class="highlighter-rouge">n</code> companies and <code class="highlighter-rouge">k</code> interns in this scenario.
For some odd reason the <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/i" class="fancy-link">i</a></code>th company likes to work with intern <code class="highlighter-rouge">i%k</code> and <code class="highlighter-rouge">(i+1)%k</code>…
A company might decide to give the interns a break from the project,
in which case they are free to be assigned to another company that wants them and won’t be reassigned until said company gives them a break.</p>
<p>Your mentor has written a simulation of this scenario with a synchronization strategy, but it does not work.
The mentor left a note that reads:</p>
<blockquote>

  <p>Dear intern, I have written a simulation of the ‘intern for rent’ program,
but sometimes a company grabs one intern,
then waits for the second intern,
which wont be released until the first intern is given a break…</p>
</blockquote>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="your-job" class="title-text">Your Job<a class="anchor title-text" href="#your-job">#</a>
</h2></div>



<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1"><ul>
  <li>Read <a href="/wikibook/deadlock-part-1-resource-allocation-graph.html#" class="fancy-link wiki-link">Resource Allocation Graphs</a> and <a href="/wikibook/deadlock-part-2-deadlock-conditions.html#" class="fancy-link wiki-link">Deadlock Conditions</a> to have all the knowledge you will need for this assignment.</li>
  <li>Read <code class="highlighter-rouge">simulator.c</code>, <code class="highlighter-rouge">bad_company.c</code>, and <code class="highlighter-rouge">company.h</code> until you have a good sense of what the code is doing (nothing will make sense until you do).</li>
  <li>Overwrite <code class="highlighter-rouge">good_company.c</code> with your correct solution (hint: look in <code class="highlighter-rouge">company.h</code> for useful functions).</li>
</ul></div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="testing" class="title-text">Testing<a class="anchor title-text" href="#testing">#</a>
</h2></div>


















<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>We provided you with a Makefile.</p>
<p>Typing</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make
</code></pre></div></div>
<p>will create the <code class="highlighter-rouge">good_company</code> and <code class="highlighter-rouge">bad_company</code> executable.
For both the <code class="highlighter-rouge">good_company</code> and <code class="highlighter-rouge">bad_company</code> executable you can execute them with 2 required arguments and 3<sup>rd</sup> optional argument as follows:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bad_company 5 6 100000
</code></pre></div></div>
<p>will run the bad solution with 5 companies and 6 interns and with a delta of 100000.
Delta is approximately how long an operation takes in microseconds (read the source code for more details).</p>
<p>If you see something like this:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Company 0 used our services for 2083 billable days.
Company 1 used our services for 2164 billable days.
Company 2 used our services for 2456 billable days.
Company 3 used our services for 2826 billable days.
Company 4 used our services for 3733 billable days.

Total Billable days : 13262
</code></pre></div></div>
<p>then the simulation terminated successfully.
This does not mean your solution is correct.
There may still be race conditions, so it it up to you to test your code thoroughly with all sorts of parameters.
If the simulator stops without billing the companies just hit <code class="highlighter-rouge">CTRL+Z</code>.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="grading" class="title-text">Grading<a class="anchor title-text" href="#grading">#</a>
</h2></div>





<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>Your grade depends on having a good working solution.</p>
<p>A good solution must have the following:</p>
<ul>
  <li>No Deadlock</li>
  <li>No Livelock</li>
  <li>Performant
    <ul>
      <li>Performance will be judged against the reference solution (<code class="highlighter-rouge">good_company_reference</code>) and measured by total billable days.</li>
      <li>You must be within <strong>90%</strong> of the reference solution to receive full points.</li>
    </ul>
  </li>
  <li>Fair (all companies should get a roughly equal number of billable days)
    <ul>
      <li>You must be within <strong>90%</strong> of than the reference solution to receive full points.</li>
      <li>Fairness is determined by <code class="highlighter-rouge">min_billable_days/max_billable_days</code> where higher is better.</li>
    </ul>
  </li>
  <li>Must adhere to the rules of the scenario</li>
  <li>Run with a single intern should not cause deadlock AND not burn cpu cycles</li>
  <li>A valid solution should not know about the number of interns or or number of companies</li>
</ul>
</div></div></div>
</div></div>
</div>
        
        <div class="wrapper">
<div class="pad"><div class="card">
<div class="title"><h2 id="submission-instructions" class="title-text">Submission Instructions<a class="anchor title-text" href="#submission-instructions">#</a>
</h2></div>















<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>Please read details on <a href="/#academic-integrity" class="fancy-link wiki-link">Academic Integrity</a> fully. These are shared by all assignments in CS 241.</p>
<p>We will be using GitHub as our hand-in system this semester. Our grading system will checkout your most recent (pre-deadline) commit for grading. Therefore, to hand in your code, all you have to do is commit and push to your Github repository.</p>
<p>To check out the provided code for <code class="highlighter-rouge">deadlocked_diners</code> from the class repository, go to your cs241 directory (the one you checked out for “know your tools”) and run:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git pull release master
</code></pre></div></div>
<p>If you run <code class="highlighter-rouge"><a href="https://linux.die.net/man/1/ls" class="fancy-link">ls</a></code> you will now see a <code class="highlighter-rouge">deadlocked_diners</code> folder, where you can find this assignment! To commit your changes (send them to us), type:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add deadlocked_diners
git commit -m "deadlocked_diners submission"
git push origin master
</code></pre></div></div>
<p>Your repository directory can be viewed from a web browser from the following URL: 
<a href="https://github-dev.cs.illinois.edu/cs241-fa18/NETID/tree/master/deadlocked_diners" class="fancy-link wiki-link">https://github-dev.cs.illinois.edu/cs241-fa18/NETID/tree/master/deadlocked_diners</a> where NETID is your University NetID. It is important to check that the files you expect to be graded are present and up to date in your remote git copy.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="assignment-feedback" class="title-text">Assignment Feedback<a class="anchor title-text" href="#assignment-feedback">#</a>
</h2></div>







<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>We strive to provide the best assignments that we can for this course, and we would like your feedback on them!</p>
<p>This is the form we will use to evaluate our assignments. We appreciate the time you take to give us your honest feedback and we promise to keep improving the course to make your experience in CS 241 the best it can be.</p>
<p><a href="https://goo.gl/forms/hREf0ojFWumYfQF12" class="fancy-link wiki-link">https://goo.gl/forms/hREf0ojFWumYfQF12</a></p>
</div></div></div>
</div></div>
</div>
      </div>
      <div class="col-md-2 col-sm-1 col-xs-0"></div>
    </div>
  </div>
  <script>
    var github_repo = "illinois-cs241/illinois-cs241.github.io";
    var github_path = "_docs/deadlocked_diners.md";
  </script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" crossorigin="anonymous"></script>
<script src="/js/main.js?v=2018-09-08 16:51:38 +0000"></script>

<script>
$(document).ready(function() { 
    $("#tuxlink").prop("href", "javascript:;").click(function() { 
        if ("WebkitAppearance" in document.documentElement.style) { 
            var style = document.createElement("style"); 
            style.setAttribute("id", "tuxstyle"); 
            style.appendChild(document.createTextNode("")); 
            document.head.appendChild(style); 
            var sheet = style.sheet;
            sheet.insertRule("::-webkit-scrollbar-thumb {border-radius: 0; background-color: white; -webkit-box-shadow: none;}", 0); 
        } 

        const hackerKey = 'hackerLocalKey';
        const hackerOff = "off";
        const hackerOn = "on";

        if (window.localStorage.getItem(hackerKey) === null) {
            window.localStorage.setItem(hackerKey, hackerOff);
        }

        $("#tuxlink").unbind('click').click(function() { 
            const hackerClass = 'hacker';
            $('html, body, header, nav, table, pre, span, :not(.card-staff) > a, p, h1, h2, h3, h4, h5, h6').toggleClass(hackerClass);
            $('ul, img, pre').toggleClass(hackerClass);
            $('.toc').toggleClass(hackerClass);
            $('.content .highlighter-rouge').toggleClass(hackerClass);
            $('.large-centered.columns').toggleClass(hackerClass);
            $('.pad').toggleClass(hackerClass);
            $('a').toggleClass(hackerClass);
            $('tbody tr:nth-child(2n+1)').toggleClass(hackerClass);
            $("#tuxlink img").toggleClass(hackerClass);

            const val = window.localStorage.getItem(hackerKey);
            if (val === hackerOff) {
                window.localStorage.setItem(hackerKey, hackerOn);
            } else {
                window.localStorage.setItem(hackerKey, hackerOff);
            }
            return false; 
        }); 
        $("#tuxlink").click();
        const stored = window.localStorage.getItem(hackerKey);
        if (stored === hackerOn) {
            console.log("Hello!")
            $("#tuxlink").click();
        } else {
            console.log("Noo");
        }

        return false; 
    }); 
    } 
    ); 
    </script>

<script src="/js/analytics.js"></script>

<footer class="">

<div class="container-fluid">
<div class="shadow"></div>

</div>

</footer>

</body>
</html>
