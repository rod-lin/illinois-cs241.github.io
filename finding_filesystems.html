<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="apple-touch-icon" sizes="180x180" href="images/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="images/favicons/manifest.json">
  <link rel="mask-icon" href="images/favicons/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="theme-color" content="#ffffff">

  <title>Finding Filesystems</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" crossorigin="anonymous">
  <link async rel="stylesheet" href="/css/code-style.css?v=2018-09-08 16:51:38 +0000">
  <link rel="stylesheet" href="/css/main.css?v=2018-09-08 16:51:38 +0000">

</head>

<body>
<!-- Always shows a header, even in smaller screens. -->
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">

            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>

            <a id="tuxlink"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAJCAMAAAA4jZ0cAAAAM1BMVEX///8CAgQMDAwsLCw0NDSjbQCkbQC+vbzOkwDU1NTlrADqvADxtgD0vQD12wD+/vz+//yBSdYEAAAAAXRSTlMAQObYZgAAADFJREFUCB0FwQkCQDAQBLCsq6g1/v9aCVQBthUwX8BIgStZCpUvKXSSLs6eyd0Pdg5+JwkBVyC74QYAAAAASUVORK5CYII=" title="Tux" alt="Tux" style="margin-left: 1em; width: 24px; filter: drop-shadow(1px 1px 0 white) drop-shadow(1px -1px 0 white) drop-shadow(-1px 1px 0 white) drop-shadow(-1px -1px 0 white); margin-top: 1em;"/></a>

            <a class="navbar-brand navbar-link normal" href="/">CS 241: System Programming</a>
            <a class="navbar-brand navbar-link small" href="/">CS 241</a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li>
            <a class="navbar-link" href="/mps.html">MPs</a>
            </li>
            <li>
            <a class="navbar-link" href="/labs.html">Labs</a>
            </li>
            <li>
            <a class="navbar-link" href="/help.html">Help!</a>
            </li>
            <li>
            <a class="navbar-link" href="/schedule.html">Schedule</a>
            </li>
            <li>
            <a class="navbar-link" href="/honors.html">Honors</a>
            </li>
            <li>
            <a class="navbar-link" href="/staff.html">The Crew</a>
            </li>
            <li>
            <a class="navbar-link" href="/search.html">Search</a>
            </li>
            <li>
            <a class="navbar-link" href="/wikibook/home.html">Wikibook</a>
            </li>
          </ul>
        </div>
        </div>
</nav>

<div class="container-fluid">
  <div class="row">
    <div class="col-md-2 col-sm-1 col-xs-0"></div>
    <div class="col-md-8 col-sm-10 col-xs-12">
      <div class="wrapper">
        <div class="pad"><div class="card">
          <div class="title">
            <div class="speaker-wrapper">
              <button onclick="speak()" class="speaker" alt="Read Page"></button>
            </div>
            <h1>
              Finding Filesystems
              
                <a class="github-link hidden-xs" href="https://github.com/illinois-cs241/illinois-cs241.github.io/blob/develop/_docs/finding_filesystems.md">Edit on Github</a>
              
            </h1>
          </div>
          <div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
            
              <div class="submission-wrapper">
                
                  <b>Entire Assignment</b> due <b>04/18/2018 11:59pm</b><br/>
                  
                    <b>Graded files:</b>
                    <ul>
                      
                        <li>minixfs.c</li>
                      
                    </ul>
                  
                
              </div>
            
          </div></div></div>
        </div></div>
      </div>
      <div class="toc-wrapper">
<h4>Content</h4>
<ul class="toc">
<li><a id="toc_quizziz" href="#quizziz" class="fancy-link">QuizzIz</a></li>
<li><a id="toc_overview" href="#overview" class="fancy-link">Overview</a></li>
<li><a id="toc_minixfs" href="#minixfs" class="fancy-link">minixfs</a></li>
<li><a id="toc_fakefs-interface" href="#fakefs-interface" class="fancy-link">fakefs interface</a></li>
<li><a id="toc_helper-functionsmacros" href="#helper-functionsmacros" class="fancy-link">Helper Functions/Macros</a></li>
<li><a id="toc_directory-structure" href="#directory-structure" class="fancy-link">Directory Structure</a></li>
<li><a id="toc_so-what-do-i-need-to-do" href="#so-what-do-i-need-to-do" class="fancy-link">So what do I need to do?</a></li>
<li><a id="toc_testing" href="#testing" class="fancy-link">Testing</a></li>
<li><a id="toc_other-edge-cases" href="#other-edge-cases" class="fancy-link">Other Edge Cases</a></li>
<li><a id="toc_helpful-hints-and-notes" href="#helpful-hints-and-notes" class="fancy-link">Helpful Hints and Notes</a></li>
<li><a id="toc_graded-files" href="#graded-files" class="fancy-link">Graded Files</a></li>
</ul>
</div>
      <div id="content">
        
        <div class="wrapper">
  <div class="pad"><div class="card">
<div class="title"><h2 id="learning-objectives" class="title-text">Learning Objectives<a class="anchor title-text" href="#learning-objectives">#</a>
</h2></div>
  
  


  <div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>
    The learning objectives for Finding Filesystems are: <br>
    </p>
<ul class="mdl-list">
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Learn how inodes are represented in the kernel</span>
        </li>
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">How to write callbacks for filesystem operations</span>
        </li>
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Traverse singly indirect blocks</span>
        </li>
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Modifing permissions on files</span>
        </li>
      
    </ul>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="suggested-readings" class="title-text">Suggested Readings<a class="anchor title-text" href="#suggested-readings">#</a>
</h2></div>
  
  

<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>
    We suggest you read the following from the
    <a href="https://github.com/angrave/SystemProgramming/wiki" class="fancy-link wiki-link">wikibook</a>
    before starting Finding Filesystems: <br>
    </p>
<ul>
      
        <li>
          <a href="/wikibook/file-system-part-1-introduction.html#" target="_blank" class="fancy-link wiki-link">File System, Part 1: Introduction
          </a>
        </li>
      
        <li>
          <a href="/wikibook/file-system-part-2-files-are-inodes-(everything-else-is-just-data...).html#" target="_blank" class="fancy-link wiki-link">File System, Part 2: Files are inodes (everything else is just data...)
          </a>
        </li>
      
        <li>
          <a href="/wikibook/file-system-part-3-permissions.html#" target="_blank" class="fancy-link wiki-link">File System, Part 3: Permissions
          </a>
        </li>
      
        <li>
          <a href="/wikibook/file-system-part-4-working-with-directories.html#" target="_blank" class="fancy-link wiki-link">File System, Part 4: Working with directories
          </a>
        </li>
      
    </ul>
</div></div></div>
</div></div>
</div>
        <div class="wrapper">
<div class="pad"><div class="card">
<div class="title"><h2 id="quizziz" class="title-text">QuizzIz<a class="anchor title-text" href="#quizziz">#</a>
</h2></div>



<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1"><p>For this week’s lab attendance grade, please fill out the google form at this link: <a href="https://docs.google.com/forms/d/e/1FAIpQLSc9tDTBZ62p2zcZq6AaYKrq4q1A6zYzWCFzdnJGHYwwvxtWDw/viewform" class="fancy-link wiki-link">https://docs.google.com/forms/d/e/1FAIpQLSc9tDTBZ62p2zcZq6AaYKrq4q1A6zYzWCFzdnJGHYwwvxtWDw/viewform</a></p></div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="overview" class="title-text">Overview<a class="anchor title-text" href="#overview">#</a>
</h2></div>





<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>Your friendly neighborhood 241 course staff asked themselves, <em>“What’s the best way to learn filesystems?”</em> Write one!</p>
<p>In this lab, you will be implementing several callbacks to file system operations, namely, <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/chmod" class="fancy-link">chmod</a></code>, <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/chown" class="fancy-link">chown</a></code>, <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/read" class="fancy-link">read</a></code>, and <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/write" class="fancy-link">write</a></code>. To do this you will be exploring how metadata is stored in the inode and how data is stored in the data blocks.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="minixfs" class="title-text">minixfs<a class="anchor title-text" href="#minixfs">#</a>
</h2></div>



































<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>ext2 is good filesystem, but to keep things simple, we will be using a modified version of its predecessor (the <a href="https://en.wikipedia.org/wiki/MINIX_file_system" class="fancy-link wiki-link">MINIX filesystem</a>) in this lab.</p>
<h3 id="superblock" class="title-text">Superblock</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
typedef struct {
	uint64_t size;
	uint64_t inode_count;
	uint64_t dblock_count;
	char data_map[0];
} superblock;

</code></pre></div></div>
<p>The superblock stores information like the size of the filesystem, the number of inodes and data blocks, and whether those data blocks are being used. Remember from class that inodes become free when their hard link count reaches zero, but data blocks need some kind of bitmap or sentinel to indicate if they are being used. <code class="highlighter-rouge">data_map</code> is a variable-sized array that holds this information. <strong>You don’t need to worry about these abstractions, they are taken care of for you</strong>.</p>
<h3 id="inodes" class="title-text">Inodes</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>typedef struct {
  uid_t uid; 
  gid_t gid; 
  uint16_t mode; 
  uint32_t nlink; 
  struct timespec atim;
  struct timespec mtim;
  struct timespec ctim;
  uint64_t size; 
  data_block_number direct[NUM_DIRECT_INODES];
  data_block_number indirect;
} inode;
</code></pre></div></div>
<p>This is the famous inode struct that you have been learning about! Here are a breakdown of the variables:</p>
<ul>
  <li>
<code class="highlighter-rouge"><a href="https://linux.die.net/man/3/uid" class="fancy-link">uid</a></code> is the user ID of the inode owner.</li>
  <li>
<code class="highlighter-rouge">gid</code> is the ID of the inode group (does not have to include the owner).</li>
  <li>
<code class="highlighter-rouge">mode</code> is a bitmask. The bottom 9 bits are read-write-execute for owner-group-others. Bits 11-10 are the type of the file. <code class="highlighter-rouge">(mode &gt;&gt; 9)</code> corresponds to a particular type. We have given you two functions, <code class="highlighter-rouge">is_file</code> and <code class="highlighter-rouge">is_directory</code>, that tell you whether or not the inode represents a directory or file. There are no other types in our filesystem.</li>
  <li>
<code class="highlighter-rouge">nlink</code> is the hard link count which is the number of directories that the file is linked to from (directories can’t be hard linked).</li>
  <li>
<code class="highlighter-rouge">atim</code> is access time, which is the time of last access or the last time a file was <code class="highlighter-rouge">read(2)</code>.</li>
  <li>
<code class="highlighter-rouge">mtim</code> is the last modification time, or in other words, the last time the file was changed with <code class="highlighter-rouge">write(2)</code>.</li>
  <li>
<code class="highlighter-rouge">ctim</code> is the last change time, or in other words, the last time the file’s metadata was changed.</li>
  <li>
<code class="highlighter-rouge"><a href="https://linux.die.net/man/1/size" class="fancy-link">size</a></code> is the size of the file in bytes</li>
  <li>
<code class="highlighter-rouge">direct</code> is an array where the <code class="highlighter-rouge">direct[i]</code> is the <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/i" class="fancy-link">i</a></code>th data block’s offset from the <code class="highlighter-rouge">data_root</code>.</li>
  <li>
<code class="highlighter-rouge">indirect</code> is the offset number (<code class="highlighter-rouge">data_block_number</code>) of a data block, which contains <code class="highlighter-rouge">NUM_INDIRECT_INODES</code> number of <code class="highlighter-rouge">data_block_number</code>’s.</li>
</ul>
<h3 id="data-blocks" class="title-text">Data blocks</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>typedef struct {
	char data[16 * KILOBYTE];
} data_block;

</code></pre></div></div>
<p>Data blocks are currently defined to be 16 kilobytes. Nothing fancy here.</p>
<h3 id="file_system-struct" class="title-text">file_system struct</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
typedef struct {
	superblock* meta;
	inode* inode_root;
	data_block* data_root;
} file_system;

</code></pre></div></div>
<p><img src="http://cs241.cs.illinois.edu/images/map.png" alt=""></p>
<p>The <code class="highlighter-rouge">file_system</code> struct keeps track of the metadata, the root inode (where <code class="highlighter-rouge">fs-&gt;inode_root[0]</code> is the root <code class="highlighter-rouge">"/"</code> inode), and the root of the <code class="highlighter-rouge">data_block</code>s.</p>
<ul>
  <li>The <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/meta" class="fancy-link">meta</a></code> pointer points to the start of the file system, which includes the superblock and the <code class="highlighter-rouge">data_map</code>.</li>
  <li>The <code class="highlighter-rouge">inode_root</code> points to the start of the inodes as in the picture, right after the <code class="highlighter-rouge">data_map</code>.</li>
  <li>The <code class="highlighter-rouge">data_root</code> points to the start of the <code class="highlighter-rouge">data_blocks</code> as in the picture, right after the inodes.</li>
</ul>
<p>The inodes and data blocks are laid sequentially out so you can treat them like an array. Think about how you could get a pointer to the nth <code class="highlighter-rouge">data_block</code>.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="fakefs-interface" class="title-text">fakefs interface<a class="anchor title-text" href="#fakefs-interface">#</a>
</h2></div>







<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>To make this lab possible, we’ve developed our own userspace filesystem interface which we’re calling fakefs. Normally, filesystem are a piece of code which you load into your kernel and must provide a few things. It needs a constructor, destructor, callbacks for all system calls involving files and file descriptors within your filesystem. However, writing kernel code is a bit more cumbersome than writing normal code (since you need additional security checks among other things), and can even lead to instability in your operating system. To avoid this, there are various ways to implment a filesystem in userspace. The most common (and preffered) method is to use a library called FUSE (Filesystems in USErspace). However, FUSE alllows you to implement your file operations in userspace, but still interacts with th ekernel to provide it’s functionality. While this allows you to mount  the filesystem and use it like any other filesystem, there a few reasons why we chose not to use it for this lab. A major reason is that if a FUSE callback crashes while it is mounted, it renders the mounted partition unsuable and in some cases, you won’t be able to even unmount the parition without rebooting the machine. To prevent this, and make this lab not annoying and tedious, we’ve made ourn own way of implementing filesystems in userspace by <code class="highlighter-rouge">hooking</code> filesystem operations.</p>
<p>If you take a look at <code class="highlighter-rouge">fakefs.c</code> you’ll see that we’ve overridden most of <code class="highlighter-rouge">glibc</code>’s filesystem operations. Note that this only hooks functions from code or programs that were either written in <code class="highlighter-rouge">C</code> or in something that compiles to <code class="highlighter-rouge">C</code>. Running a program written in assembly will not be affected by these hooks.</p>
<p>Note that not all programs will work with fakefs. At the least, we guarantee that <code class="highlighter-rouge"><a href="https://linux.die.net/man/1/ls" class="fancy-link">ls</a></code>, <code class="highlighter-rouge"><a href="https://linux.die.net/man/1/cat" class="fancy-link">cat</a></code>, <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/mkdir" class="fancy-link">mkdir</a></code>, <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/unlink" class="fancy-link">unlink</a></code> and <code class="highlighter-rouge"><a href="https://linux.die.net/man/1/cp" class="fancy-link">cp</a></code> work. <code class="highlighter-rouge"><a href="https://linux.die.net/man/1/vim" class="fancy-link">vim</a></code> and <code class="highlighter-rouge">neovim</code> seem to work although you might run into some weird bugs using these programs within fakefs.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="helper-functionsmacros" class="title-text">Helper Functions/Macros<a class="anchor title-text" href="#helper-functionsmacros">#</a>
</h2></div>



















<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>There are some functions that you are going to need to know in order to finish this lab.</p>
<h3 id="get_inode" class="title-text"><code class="highlighter-rouge">get_inode</code></h3>
<p>This function takes a string name like <code class="highlighter-rouge">/path/to/file</code> and returns the inode corresponding to the file at end of that path. <code class="highlighter-rouge">get_inode</code> returns NULL when the intended file does not exist or the file is invalid.</p>
<h3 id="is_file--is_directory" class="title-text">
<code class="highlighter-rouge">is_file</code> / <code class="highlighter-rouge">is_directory</code>
</h3>
<p>Call <code class="highlighter-rouge">is_file</code> or <code class="highlighter-rouge">is_directory</code> on an inode to tell whether it is a directory or a file. You don’t need to consider other inode types.</p>
<h3 id="num_direct_inodes" class="title-text"><code class="highlighter-rouge">NUM_DIRECT_INODES</code></h3>
<p><code class="highlighter-rouge">NUM_DIRECT_INODES</code> is the number of direct <code class="highlighter-rouge">data_block</code> nodes in a single inode. The <code class="highlighter-rouge">indirect</code> array has only this many entries (for the sake of simplicity).</p>
<h3 id="unassigned_node" class="title-text"><code class="highlighter-rouge">UNASSIGNED_NODE</code></h3>
<p>You may not need to use this macro, but if you choose to, then any <code class="highlighter-rouge">data_block</code> or <code class="highlighter-rouge">inode</code> that is not currently being used will have this number.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="directory-structure" class="title-text">Directory Structure<a class="anchor title-text" href="#directory-structure">#</a>
</h2></div>











<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>Our directory <code class="highlighter-rouge">data_blocks</code> looks like the following:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
|--248 Byte Name String--||-8 Byte Inode Number-|
|--248 Byte Name String--||-8 Byte Inode Number-|
...

</code></pre></div></div>
<p>The filesystem guarantees that size of a directory is a multiple of 256. You need to loop through all of the directory entries and get the name of the entry, and print it out to standard out. You are going to need to call two different print functions based on whether the inode that you are pointing to is a directory or a file, which means you have to get the inode number and check that inode.</p>
<p>Use <code class="highlighter-rouge">make_dirent_from_string</code>: it accepts a <code class="highlighter-rouge">char* ptr</code> to the start of a dirent block like this.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
|--248 Byte Name String--||-8 Byte Inode Number-|
^ -- Points here
</code></pre></div></div>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="so-what-do-i-need-to-do" class="title-text">So what do I need to do?<a class="anchor title-text" href="#so-what-do-i-need-to-do">#</a>
</h2></div>









<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>You will need to implement the following 4 functions</p>
<ul>
  <li><code class="highlighter-rouge">int minixfs_chmod(file_system *fs, char *path, int new_permissions)</code></li>
  <li><code class="highlighter-rouge">int minixfs_chown(file_system *fs, char *path, uid_t owner, gid_t group)</code></li>
  <li><code class="highlighter-rouge">ssize_t minixfs_read(file_system *fs, const char *path, void *buf, size_t req, off_t *off)</code></li>
  <li><code class="highlighter-rouge">ssize_t minixfs_write(file_system *fs, const char *path, const void *buf, size_t count, off_t *off)</code></li>
</ul>
<p>You can find more information about these functions in <code class="highlighter-rouge">minixfs.h</code>. Remember to set <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/errno" class="fancy-link">errno</a></code> on errors in your code!</p>
<p>Note that for all functions where you need to update times, you should use <code class="highlighter-rouge">clock_gettime(CLOCK_REALTIME, variable_to_update);</code>.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="testing" class="title-text">Testing<a class="anchor title-text" href="#testing">#</a>
</h2></div>































<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p><strong>Testing is ungraded, but highly recommended</strong></p>
<p>You can grab the test filesystem using <code class="highlighter-rouge">make testfs</code>. <strong>Do not commit this file. If you overwrite it and want the original version just <code class="highlighter-rouge">rm test.fs</code> and do <code class="highlighter-rouge">make testfs</code> again</strong></p>
<p>You will probably want to reset your <code class="highlighter-rouge">test.fs</code> file frequently while testing your write functionality.</p>
<p>Note: There’s a small chance that <code class="highlighter-rouge">make testfs</code> can fail - in this case <code class="highlighter-rouge">rm test.fs</code> and <code class="highlighter-rouge">make testfs</code> again.</p>
<p>make will generate the minixfs_test executable that you can use for testing. We strongly reccomend writing your own testcases in <code class="highlighter-rouge">minixfs_test.c</code> and not just on the output of commands like <code class="highlighter-rouge"><a href="https://linux.die.net/man/1/ls" class="fancy-link">ls</a></code> and <code class="highlighter-rouge"><a href="https://linux.die.net/man/1/cat" class="fancy-link">cat</a></code> (which we describe how to test with below). This is because subtle bugs in your code can make the output look right, but have random unprintable characters as well.</p>
<p>The <code class="highlighter-rouge">goodies</code> directory is also included and can also be used to check against the /goodies directory in test.fs.
For example, the output of:
<code class="highlighter-rouge">./fakefs test.fs cat test.fs/goodies/hello.txt</code> should be the same as <code class="highlighter-rouge">cat ./goodies/hello.txt</code></p>
<p>Here are some sample (and not comprehensive) testcases!</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ./fakefs test.fs cat /goodies/hello.txt
Hello World!
$
</code></pre></div></div>
<p>You can even cat directories!</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ./fakefs test.fs cat /
you00000001got00000002ls!00000003congrats00000004 [...]
$
</code></pre></div></div>
<p>So that’s what really is going on under the hood?</p>
<p>Want something fun?</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
$ ./fakefs test.fs cat test.fs/goodies/dog.png &gt; dog.png
$ xdg-open dog.png

</code></pre></div></div>
<p>You can store anything on filesystems. See what we hid around the testfs filesystem for you…</p>
<p>You can also test by generating your own filesystems. Simply run ./fakefs mkfs <em>filename</em> to generate a filesystem with the filename <em>filename</em>. If you’ve implemented the write functionality, you can use commands like ./fakefs cp <em>file1</em> <em>filename</em>/ to copy files over. programs like <code class="highlighter-rouge"><a href="https://linux.die.net/man/3/mkdir" class="fancy-link">mkdir</a></code> should work as well.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="other-edge-cases" class="title-text">Other Edge Cases<a class="anchor title-text" href="#other-edge-cases">#</a>
</h2></div>



<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1"><ul>
  <li>You do need to update <code class="highlighter-rouge">atim</code> and the <code class="highlighter-rouge">ctim</code>!</li>
  <li>You don’t need to worry about data corruption or checksums or anything fancy, the filesystem will be valid. (Unless your write has bugs in it)</li>
  <li>Make sure all the files you cat out in <code class="highlighter-rouge">/goodies</code> look correct when you <code class="highlighter-rouge"><a href="https://linux.die.net/man/1/xdg-open" class="fancy-link">xdg-open</a></code> them. Make sure you can get the PNGs and the PDFs to print out correctly.</li>
  <li>Make sure your output is the same size as the files inside the filesystem. You can check this by running stat on the files inside the filesystem(<code class="highlighter-rouge">./fakefs test.fs stat test.fs/FILE_PATH</code>), and wc -c on the on output of running cat on the file (<code class="highlighter-rouge">./fakefs test.fs cat test.fs/FILE_PATH | wc -c</code>) to check that the number of bytes is the same.</li>
</ul></div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="helpful-hints-and-notes" class="title-text">Helpful Hints and Notes<a class="anchor title-text" href="#helpful-hints-and-notes">#</a>
</h2></div>



<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1"><ul>
  <li>Handle the edge conditions. You can assume that size will be valid. What is the code supposed to do when you get to a singly indirect block?</li>
  <li>Draw pictures! Understand what each of the things in the structs mean.</li>
  <li>Review your pointer arithmetic.</li>
  <li>
<strong>Only</strong> change<code class="highlighter-rouge">minixfs.c</code>.</li>
</ul></div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="graded-files" class="title-text">Graded Files<a class="anchor title-text" href="#graded-files">#</a>
</h2></div>




<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<ul>
  <li><code class="highlighter-rouge">minixfs.c</code></li>
</ul>
<p><strong>Anything not specified in these docs is considered undefined behavior, and we will not test it.</strong></p>
</div></div></div>
</div></div>
</div>
        
        <div class="wrapper">
<div class="pad"><div class="card">
<div class="title"><h2 id="submission-instructions" class="title-text">Submission Instructions<a class="anchor title-text" href="#submission-instructions">#</a>
</h2></div>















<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>Please read details on <a href="/#academic-integrity" class="fancy-link wiki-link">Academic Integrity</a> fully. These are shared by all assignments in CS 241.</p>
<p>We will be using GitHub as our hand-in system this semester. Our grading system will checkout your most recent (pre-deadline) commit for grading. Therefore, to hand in your code, all you have to do is commit and push to your Github repository.</p>
<p>To check out the provided code for <code class="highlighter-rouge">finding_filesystems</code> from the class repository, go to your cs241 directory (the one you checked out for “know your tools”) and run:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git pull release master
</code></pre></div></div>
<p>If you run <code class="highlighter-rouge"><a href="https://linux.die.net/man/1/ls" class="fancy-link">ls</a></code> you will now see a <code class="highlighter-rouge">finding_filesystems</code> folder, where you can find this assignment! To commit your changes (send them to us), type:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add finding_filesystems
git commit -m "finding_filesystems submission"
git push origin master
</code></pre></div></div>
<p>Your repository directory can be viewed from a web browser from the following URL: 
<a href="https://github-dev.cs.illinois.edu/cs241-fa18/NETID/tree/master/finding_filesystems" class="fancy-link wiki-link">https://github-dev.cs.illinois.edu/cs241-fa18/NETID/tree/master/finding_filesystems</a> where NETID is your University NetID. It is important to check that the files you expect to be graded are present and up to date in your remote git copy.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="assignment-feedback" class="title-text">Assignment Feedback<a class="anchor title-text" href="#assignment-feedback">#</a>
</h2></div>







<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>We strive to provide the best assignments that we can for this course, and we would like your feedback on them!</p>
<p>This is the form we will use to evaluate our assignments. We appreciate the time you take to give us your honest feedback and we promise to keep improving the course to make your experience in CS 241 the best it can be.</p>
<p><a href="https://goo.gl/forms/hREf0ojFWumYfQF12" class="fancy-link wiki-link">https://goo.gl/forms/hREf0ojFWumYfQF12</a></p>
</div></div></div>
</div></div>
</div>
      </div>
      <div class="col-md-2 col-sm-1 col-xs-0"></div>
    </div>
  </div>
  <script>
    var github_repo = "illinois-cs241/illinois-cs241.github.io";
    var github_path = "_docs/finding_filesystems.md";
  </script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" crossorigin="anonymous"></script>
<script src="/js/main.js?v=2018-09-08 16:51:38 +0000"></script>

<script>
$(document).ready(function() { 
    $("#tuxlink").prop("href", "javascript:;").click(function() { 
        if ("WebkitAppearance" in document.documentElement.style) { 
            var style = document.createElement("style"); 
            style.setAttribute("id", "tuxstyle"); 
            style.appendChild(document.createTextNode("")); 
            document.head.appendChild(style); 
            var sheet = style.sheet;
            sheet.insertRule("::-webkit-scrollbar-thumb {border-radius: 0; background-color: white; -webkit-box-shadow: none;}", 0); 
        } 

        const hackerKey = 'hackerLocalKey';
        const hackerOff = "off";
        const hackerOn = "on";

        if (window.localStorage.getItem(hackerKey) === null) {
            window.localStorage.setItem(hackerKey, hackerOff);
        }

        $("#tuxlink").unbind('click').click(function() { 
            const hackerClass = 'hacker';
            $('html, body, header, nav, table, pre, span, :not(.card-staff) > a, p, h1, h2, h3, h4, h5, h6').toggleClass(hackerClass);
            $('ul, img, pre').toggleClass(hackerClass);
            $('.toc').toggleClass(hackerClass);
            $('.content .highlighter-rouge').toggleClass(hackerClass);
            $('.large-centered.columns').toggleClass(hackerClass);
            $('.pad').toggleClass(hackerClass);
            $('a').toggleClass(hackerClass);
            $('tbody tr:nth-child(2n+1)').toggleClass(hackerClass);
            $("#tuxlink img").toggleClass(hackerClass);

            const val = window.localStorage.getItem(hackerKey);
            if (val === hackerOff) {
                window.localStorage.setItem(hackerKey, hackerOn);
            } else {
                window.localStorage.setItem(hackerKey, hackerOff);
            }
            return false; 
        }); 
        $("#tuxlink").click();
        const stored = window.localStorage.getItem(hackerKey);
        if (stored === hackerOn) {
            console.log("Hello!")
            $("#tuxlink").click();
        } else {
            console.log("Noo");
        }

        return false; 
    }); 
    } 
    ); 
    </script>

<script src="/js/analytics.js"></script>

<footer class="">

<div class="container-fluid">
<div class="shadow"></div>

</div>

</footer>

</body>
</html>
